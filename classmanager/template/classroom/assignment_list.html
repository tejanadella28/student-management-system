{% extends 'classroom/base.html' %}
{% block content %}

<div class="container mt-4">
  <!-- Page Header -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h1 class="h3 mb-0 text-gray-800">
        <i class="fas fa-clipboard-list me-2 text-primary"></i>
        Assignment Management
      </h1>
      <p class="text-muted mb-0">Manage and track your uploaded assignments</p>
    </div>
    <a href="{% url 'classroom:upload_assignment' %}" class="btn btn-primary">
      <i class="fas fa-plus me-2"></i>Upload New Assignment
    </a>
  </div>

  {% if teacher.teacher_assignment.count == 0 %}
    <!-- Empty State -->
    <div class="text-center py-5">
      <div class="empty-state">
        <div class="empty-icon mb-4">
          <i class="fas fa-clipboard-list text-muted" style="font-size: 4rem;"></i>
        </div>
        <h3 class="text-muted mb-3">No Assignments Yet</h3>
        <p class="text-muted mb-4">You haven't uploaded any assignments yet. Start by creating your first assignment.</p>
        <a href="{% url 'classroom:upload_assignment' %}" class="btn btn-primary btn-lg">
          <i class="fas fa-plus me-2"></i>Upload First Assignment
        </a>
      </div>
    </div>
  {% else %}
    <!-- Assignments Grid -->
    <div class="row">
      {% for assignment in teacher.teacher_assignment.all %}
        <div class="col-lg-6 col-xl-4 mb-4">
          <div class="card assignment-card border-0 shadow-sm h-100">
            <div class="card-header bg-primary text-white">
              <div class="d-flex align-items-center">
                <i class="fas fa-file-alt me-2"></i>
                <h6 class="mb-0 text-truncate">{{ assignment.assignment_name }}</h6>
              </div>
            </div>
            
            <div class="card-body">
              <div class="assignment-info mb-3">
                <div class="info-item d-flex align-items-center mb-2">
                  <i class="fas fa-calendar-alt text-muted me-2"></i>
                  <span class="text-muted">Uploaded:</span>
                  <span class="ms-2">{{ assignment.created_at|date:"M d, Y" }}</span>
                </div>
                <div class="info-item d-flex align-items-center">
                  <i class="fas fa-clock text-muted me-2"></i>
                  <span class="text-muted">Time:</span>
                  <span class="ms-2">{{ assignment.created_at|date:"g:i A" }}</span>
                </div>
              </div>
            </div>
            
            <div class="card-footer bg-light border-0">
              <div class="d-grid gap-2">
                <div class="btn-group" role="group">
                  <a href="{{ assignment.assignment.url }}" 
                     class="btn btn-outline-primary btn-sm" 
                     target="_blank" 
                     title="Download Assignment">
                    <i class="fas fa-download me-1"></i>Download
                  </a>
                  <a href="{% url 'classroom:update_assignment' id=assignment.id %}" 
                     class="btn btn-outline-info btn-sm" 
                     title="Edit Assignment">
                    <i class="fas fa-edit me-1"></i>Edit
                  </a>
                  <a href="{% url 'classroom:assignment_delete' id=assignment.id %}" 
                     class="btn btn-outline-danger btn-sm" 
                     title="Delete Assignment">
                    <i class="fas fa-trash me-1"></i>Delete
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>

    <!-- Statistics Card -->
    <div class="row mt-4">
      <div class="col-md-12">
        <div class="card border-0 shadow-sm">
          <div class="card-body">
            <div class="row text-center">
              <div class="col-md-4">
                <div class="stat-item">
                  <i class="fas fa-clipboard-list text-primary mb-2" style="font-size: 2rem;"></i>
                  <h4 class="mb-0">{{ teacher.teacher_assignment.count }}</h4>
                  <small class="text-muted">Total Assignments</small>
                </div>
              </div>
              <div class="col-md-4">
                <div class="stat-item">
                  <i class="fas fa-calendar-week text-success mb-2" style="font-size: 2rem;"></i>
                  <h4 class="mb-0">{{ teacher.teacher_assignment.count }}</h4>
                  <small class="text-muted">This Month</small>
                </div>
              </div>
              <div class="col-md-4">
                <div class="stat-item">
                  <i class="fas fa-users text-info mb-2" style="font-size: 2rem;"></i>
                  <h4 class="mb-0">{{ teacher.students.count }}</h4>
                  <small class="text-muted">Students</small>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  {% endif %}
</div>

<!-- Custom Styles -->
<style>
  .assignment-card {
    transition: transform 0.2s ease, box-shadow 0.2s ease;
    border-radius: 12px;
    overflow: hidden;
  }
  
  .assignment-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 25px rgba(0,0,0,0.1) !important;
  }
  
  .card-header {
    border-radius: 12px 12px 0 0 !important;
    background: linear-gradient(135deg, #4f46e5 0%, #6366f1 100%) !important;
  }
  
  .btn {
    border-radius: 8px;
    font-weight: 500;
    transition: all 0.3s ease;
  }
  
  .btn:hover {
    transform: translateY(-1px);
  }
  
  .btn-primary {
    background: linear-gradient(135deg, #4f46e5 0%, #6366f1 100%);
    border: none;
  }
  
  .btn-outline-primary:hover {
    background: linear-gradient(135deg, #4f46e5 0%, #6366f1 100%);
    border-color: #4f46e5;
  }
  
  .btn-outline-info:hover {
    background: #17a2b8;
    border-color: #17a2b8;
  }
  
  .btn-outline-danger:hover {
    background: #dc3545;
    border-color: #dc3545;
  }
  
  .empty-state {
    max-width: 500px;
    margin: 0 auto;
  }
  
  .empty-icon {
    opacity: 0.5;
  }
  
  .info-item {
    font-size: 0.9rem;
  }
  
  .stat-item {
    padding: 1rem;
  }
  
  .text-gray-800 {
    color: #1f2937 !important;
  }
  
  .bg-light {
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%) !important;
  }
  
  @media (max-width: 768px) {
    .d-flex.justify-content-between {
      flex-direction: column;
      gap: 1rem;
    }
    
    .assignment-card {
      margin-bottom: 1rem;
    }
    
    .btn-group {
      flex-direction: column;
    }
    
    .btn-group .btn {
      border-radius: 8px !important;
      margin-bottom: 0.25rem;
    }
  }
  
  /* Animation for cards */
  .assignment-card {
    animation: fadeInUp 0.6s ease-out;
  }
  
  .assignment-card:nth-child(2) { animation-delay: 0.1s; }
  .assignment-card:nth-child(3) { animation-delay: 0.2s; }
  .assignment-card:nth-child(4) { animation-delay: 0.3s; }
  
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>

<!-- Enhanced functionality -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Add confirmation for delete buttons
    const deleteButtons = document.querySelectorAll('a[href*="assignment_delete"]');
    deleteButtons.forEach(button => {
      button.addEventListener('click', function(e) {
        e.preventDefault();
        if (confirm('Are you sure you want to delete this assignment?')) {
          window.location.href = this.href;
        }
      });
    });
    
    // Add loading state for download buttons
    const downloadButtons = document.querySelectorAll('a[target="_blank"]');
    downloadButtons.forEach(button => {
      button.addEventListener('click', function() {
        const originalText = this.innerHTML;
        this.innerHTML = '<i class="fas fa-spinner fa-spin me-1"></i>Downloading...';
        setTimeout(() => {
          this.innerHTML = originalText;
        }, 2000);
      });
    });
  });
</script>

{% endblock %}
